{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Tyler\\\\Downloads\\\\PrecisionTracker-v4-wired\\\\PrecisionTracker\\\\mobile\\\\App.js\";\nimport React, { useEffect, useState, createContext, useContext, useRef } from 'react';\nimport { NavigationContainer } from '@react-navigation/native';\nimport { createNativeStackNavigator } from '@react-navigation/native-stack';\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport * as ImagePicker from 'expo-image-picker';\nimport * as SQLite from 'expo-sqlite';\nimport Svg, { Path } from 'react-native-svg';\nimport ViewShot from 'react-native-view-shot';\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport View from \"react-native-web/dist/exports/View\";\nimport * as SecureStore from 'expo-secure-store';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = process.env.EXPO_PUBLIC_API_URL || 'http://localhost:4000';\nlet db;\nexport function getDb() {\n  if (db) return db;\n  if (Platform.OS === 'web') {\n    db = {\n      transaction: fn => fn({\n        executeSql: () => {}\n      }),\n      execAsync: async () => {},\n      runAsync: async () => {}\n    };\n    return db;\n  }\n  if ('openDatabaseSync' in SQLite) {\n    db = SQLite.openDatabaseSync('offline.db');\n    return db;\n  }\n  if ('openDatabaseAsync' in SQLite) {\n    Alert.alert('Info', 'Using async SQLite; offline queue limited until refactor.');\n    db = {\n      transaction: fn => fn({\n        executeSql: () => {}\n      }),\n      execAsync: async () => {},\n      runAsync: async () => {}\n    };\n    return db;\n  }\n  db = {\n    transaction: fn => fn({\n      executeSql: () => {}\n    }),\n    execAsync: async () => {},\n    runAsync: async () => {}\n  };\n  return db;\n}\nconst dbHandle = getDb();\nconst AuthContext = createContext(null);\nfunction useAuth() {\n  return useContext(AuthContext);\n}\nasync function api(path, method = 'GET', body, token) {\n  const res = await fetch(`${API_URL}${path}`, {\n    method,\n    headers: Object.assign({\n      'Content-Type': 'application/json'\n    }, token ? {\n      Authorization: `Bearer ${token}`\n    } : {}),\n    body: body ? JSON.stringify(body) : undefined\n  });\n  if (!res.ok) {\n    throw new Error((await res.json()).error || 'Request failed');\n  }\n  return res.json();\n}\nfunction SignaturePad({\n  onCapturePng\n}) {\n  const [points, setPoints] = useState([]);\n  const [path, setPath] = useState('');\n  const shotRef = useRef(null);\n  return _jsxDEV(ViewShot, {\n    ref: shotRef,\n    options: {\n      format: 'png',\n      quality: 0.9,\n      result: 'base64'\n    },\n    style: {\n      height: 220,\n      borderWidth: 1,\n      backgroundColor: '#fff'\n    },\n    children: _jsxDEV(View, {\n      onStartShouldSetResponder: () => true,\n      onResponderMove: e => {\n        const x = e.nativeEvent.locationX,\n          y = e.nativeEvent.locationY;\n        setPath(p => p + (p ? ` L ${x} ${y}` : ` M ${x} ${y}`));\n      },\n      onResponderRelease: async () => {\n        const base64 = await shotRef.current.capture();\n        onCapturePng && onCapturePng('data:image/png;base64,' + base64);\n      },\n      style: {\n        flex: 1\n      },\n      children: _jsxDEV(Svg, {\n        height: \"100%\",\n        width: \"100%\",\n        children: _jsxDEV(Path, {\n          d: path,\n          stroke: \"black\",\n          strokeWidth: \"2\",\n          fill: \"none\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 41\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n}\nfunction SignatureScreen({\n  route,\n  navigation\n}) {\n  const {\n    token\n  } = useAuth();\n  const {\n    estimateId\n  } = route.params;\n  const [sigPng, setSigPng] = useState(null);\n  const save = async () => {\n    if (!sigPng) {\n      Alert.alert('Please sign first');\n      return;\n    }\n    const resp = await api(`/estimates/${estimateId}/approve`, 'POST', {\n      signaturePngUrl: sigPng\n    }, token);\n    Alert.alert('Approved', `Payment link:\\n${resp && resp.paymentLink ? resp.paymentLink : 'Unavailable'}`);\n    navigation.goBack();\n  };\n  return _jsxDEV(SafeAreaView, {\n    style: {\n      padding: 16\n    },\n    children: [_jsxDEV(Text, {\n      style: {\n        fontSize: 18,\n        marginBottom: 8\n      },\n      children: [\"Sign Estimate #\", estimateId]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this), _jsxDEV(SignaturePad, {\n      onCapturePng: setSigPng\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this), _jsxDEV(View, {\n      style: {\n        height: 12\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this), _jsxDEV(Button, {\n      title: \"Save Signature\",\n      onPress: save\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 5\n  }, this);\n}\nfunction UsersAdminScreen() {\n  const {\n    token\n  } = useAuth();\n  const [users, setUsers] = useState([]);\n  const [email, setEmail] = useState('');\n  const [fullName, setFullName] = useState('');\n  const [role, setRole] = useState('TECH');\n  const load = async () => setUsers(await api('/users', 'GET', null, token));\n  useEffect(() => {\n    load();\n  }, []);\n  const invite = async () => {\n    await api('/users', 'POST', {\n      email,\n      fullName,\n      role\n    }, token);\n    setEmail('');\n    setFullName('');\n    setRole('TECH');\n    load();\n  };\n  const promote = async (id, newRole) => {\n    await api(`/users/${id}`, 'PATCH', {\n      role: newRole\n    }, token);\n    load();\n  };\n  return _jsxDEV(SafeAreaView, {\n    style: {\n      flex: 1,\n      padding: 16\n    },\n    children: [_jsxDEV(Text, {\n      style: {\n        fontSize: 18,\n        fontWeight: '600'\n      },\n      children: \"Invite User\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Full name\",\n      value: fullName,\n      onChangeText: setFullName,\n      style: {\n        borderWidth: 1,\n        padding: 8,\n        marginVertical: 6\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Email\",\n      value: email,\n      onChangeText: setEmail,\n      autoCapitalize: \"none\",\n      style: {\n        borderWidth: 1,\n        padding: 8,\n        marginVertical: 6\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Role (ADMIN/ESTIMATOR/SUPERVISOR/TECH)\",\n      value: role,\n      onChangeText: setRole,\n      style: {\n        borderWidth: 1,\n        padding: 8,\n        marginVertical: 6\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }, this), _jsxDEV(Button, {\n      title: \"Create User\",\n      onPress: invite\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this), _jsxDEV(View, {\n      style: {\n        height: 16\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }, this), _jsxDEV(FlatList, {\n      data: users,\n      keyExtractor: u => String(u.id),\n      renderItem: ({\n        item\n      }) => _jsxDEV(View, {\n        style: {\n          padding: 12,\n          borderWidth: 1,\n          marginBottom: 8\n        },\n        children: [_jsxDEV(Text, {\n          style: {\n            fontWeight: '600'\n          },\n          children: item.fullName || item.email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 11\n        }, this), _jsxDEV(Text, {\n          children: item.email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, this), _jsxDEV(Text, {\n          children: [\"Role: \", item.role]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 11\n        }, this), _jsxDEV(View, {\n          style: {\n            flexDirection: 'row',\n            gap: 8,\n            marginTop: 8\n          },\n          children: [_jsxDEV(Button, {\n            title: \"Admin\",\n            onPress: () => promote(item.id, 'ADMIN')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 13\n          }, this), _jsxDEV(Button, {\n            title: \"Estimator\",\n            onPress: () => promote(item.id, 'ESTIMATOR')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 13\n          }, this), _jsxDEV(Button, {\n            title: \"Supervisor\",\n            onPress: () => promote(item.id, 'SUPERVISOR')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 13\n          }, this), _jsxDEV(Button, {\n            title: \"Tech\",\n            onPress: () => promote(item.id, 'TECH')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 142,\n    columnNumber: 5\n  }, this);\n}\nfunction JobsKanbanScreen({\n  navigation\n}) {\n  const {\n    token\n  } = useAuth();\n  const [jobs, setJobs] = useState([]);\n  const load = async () => setJobs(await api('/jobs', 'GET', null, token));\n  useEffect(() => {\n    load();\n  }, []);\n  const columns = ['SCHEDULED', 'IN_PROGRESS', 'ON_HOLD', 'DONE'];\n  return _jsxDEV(SafeAreaView, {\n    style: {\n      flex: 1\n    },\n    children: _jsxDEV(ScrollView, {\n      horizontal: true,\n      contentContainerStyle: {\n        padding: 12\n      },\n      children: columns.map(col => _jsxDEV(View, {\n        style: {\n          width: 300,\n          marginRight: 12\n        },\n        children: [_jsxDEV(Text, {\n          style: {\n            fontWeight: '700',\n            marginBottom: 8\n          },\n          children: col\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 13\n        }, this), jobs.filter(j => j.status === col).map(j => _jsxDEV(TouchableOpacity, {\n          style: {\n            borderWidth: 1,\n            padding: 10,\n            borderRadius: 8,\n            marginBottom: 8\n          },\n          onPress: () => navigation.navigate('JobDetail', {\n            jobId: j.id\n          }),\n          children: [_jsxDEV(Text, {\n            style: {\n              fontWeight: '600'\n            },\n            children: j.name || `Job #${j.id}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 17\n          }, this), _jsxDEV(Text, {\n            children: [\"#\", j.id]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 17\n          }, this)]\n        }, j.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 15\n        }, this))]\n      }, col, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 174,\n    columnNumber: 5\n  }, this);\n}\nfunction JobDetailScreen({\n  route\n}) {\n  const {\n    jobId\n  } = route.params;\n  const {\n    token,\n    user\n  } = useAuth();\n  const [changeOrders, setCO] = useState([]);\n  const [title, setTitle] = useState('');\n  const [amountDelta, setAmountDelta] = useState('0');\n  const load = async () => setCO(await api(`/change-orders/job/${jobId}`, 'GET', null, token));\n  useEffect(() => {\n    load();\n  }, []);\n  const addCO = async () => {\n    await api(`/change-orders/job/${jobId}`, 'POST', {\n      title,\n      amountDelta: parseFloat(amountDelta)\n    }, token);\n    setTitle('');\n    setAmountDelta('0');\n    load();\n  };\n  return _jsxDEV(SafeAreaView, {\n    style: {\n      flex: 1,\n      padding: 16\n    },\n    children: [_jsxDEV(Text, {\n      style: {\n        fontSize: 18,\n        fontWeight: '600'\n      },\n      children: [\"Job #\", jobId]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }, this), (user?.role === 'ADMIN' || user?.role === 'SUPERVISOR' || user?.role === 'ESTIMATOR') && _jsxDEV(View, {\n      style: {\n        marginVertical: 10\n      },\n      children: [_jsxDEV(Text, {\n        style: {\n          fontWeight: '600'\n        },\n        children: \"New Change Order\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 11\n      }, this), _jsxDEV(TextInput, {\n        placeholder: \"Title\",\n        value: title,\n        onChangeText: setTitle,\n        style: {\n          borderWidth: 1,\n          padding: 8,\n          marginVertical: 6\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 11\n      }, this), _jsxDEV(TextInput, {\n        placeholder: \"Amount \\u0394\",\n        value: amountDelta,\n        onChangeText: setAmountDelta,\n        keyboardType: \"decimal-pad\",\n        style: {\n          borderWidth: 1,\n          padding: 8,\n          marginVertical: 6\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 11\n      }, this), _jsxDEV(Button, {\n        title: \"Add Change Order\",\n        onPress: addCO\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 9\n    }, this), _jsxDEV(Text, {\n      style: {\n        fontWeight: '600',\n        marginTop: 12\n      },\n      children: \"Change Orders\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 7\n    }, this), _jsxDEV(FlatList, {\n      data: changeOrders,\n      keyExtractor: i => String(i.id),\n      renderItem: ({\n        item\n      }) => _jsxDEV(View, {\n        style: {\n          borderWidth: 1,\n          padding: 10,\n          borderRadius: 8,\n          marginVertical: 6\n        },\n        children: [_jsxDEV(Text, {\n          style: {\n            fontWeight: '600'\n          },\n          children: item.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this), _jsxDEV(Text, {\n          children: [\"Status: \", item.status, \" | \\u0394 $\", item.amountDelta]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 205,\n    columnNumber: 5\n  }, this);\n}\nasync function processQueue(token) {\n  return new Promise(resolve => {\n    db.transaction(tx => {\n      tx.executeSql('SELECT * FROM queue', [], async (_, {\n        rows\n      }) => {\n        const items = rows._array || [];\n        for (const q of items) {\n          try {\n            const payload = JSON.parse(q.payload);\n            if (q.type === 'createLead') {\n              await api('/leads', 'POST', payload, token);\n            }\n            if (q.type === 'uploadPhoto') {\n              await api('/upload/image', 'POST', {\n                dataUrl: payload.dataUrl\n              }, token);\n            }\n            db.transaction(txx => txx.executeSql('DELETE FROM queue WHERE id=?', [q.id]));\n          } catch (e) {}\n        }\n        resolve();\n      });\n    });\n  });\n}\nfunction LeadsScreen({\n  navigation\n}) {\n  const {\n    token\n  } = useAuth();\n  const [leads, setLeads] = useState([]);\n  const fetchLeads = async () => {\n    try {\n      const data = await api('/leads', 'GET', null, token);\n      setLeads(data);\n      db.transaction(tx => {\n        tx.executeSql('DELETE FROM leads_cache;');\n        data.forEach(l => tx.executeSql('INSERT OR REPLACE INTO leads_cache (id, description, status) VALUES (?,?,?)', [l.id, l.description || '', l.status || 'NEW']));\n      });\n    } catch (e) {\n      db.transaction(tx => tx.executeSql('SELECT id, description, status FROM leads_cache', [], (_, {\n        rows\n      }) => setLeads(rows._array || [])));\n    }\n  };\n  useEffect(() => {\n    fetchLeads();\n  }, []);\n  return _jsxDEV(SafeAreaView, {\n    style: {\n      flex: 1\n    },\n    children: _jsxDEV(FlatList, {\n      data: leads,\n      keyExtractor: item => String(item.id),\n      contentContainerStyle: {\n        padding: 12\n      },\n      renderItem: ({\n        item\n      }) => _jsxDEV(TouchableOpacity, {\n        style: {\n          padding: 12,\n          borderWidth: 1,\n          marginBottom: 8\n        },\n        onPress: () => navigation.navigate('EstimateEditor', {\n          leadId: item.id\n        }),\n        children: [_jsxDEV(Text, {\n          style: {\n            fontWeight: '600'\n          },\n          children: [\"Lead #\", item.id]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 13\n        }, this), _jsxDEV(Text, {\n          numberOfLines: 2,\n          children: item.description || 'No description'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 13\n        }, this), _jsxDEV(Text, {\n          children: [\"Status: \", item.status]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 11\n      }, this),\n      ListHeaderComponent: _jsxDEV(Button, {\n        title: \"New Lead\",\n        onPress: () => navigation.navigate('NewLead')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 30\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 263,\n    columnNumber: 5\n  }, this);\n}\nfunction NewLeadScreen({\n  navigation\n}) {\n  const {\n    token\n  } = useAuth();\n  const [description, setDescription] = useState('');\n  const createLeadOnline = async () => {\n    await api('/leads', 'POST', {\n      description\n    }, token);\n  };\n  const queueLead = () => {\n    db.transaction(tx => tx.executeSql('INSERT INTO queue (type, payload) VALUES (?,?)', ['createLead', JSON.stringify({\n      description\n    })]));\n    Alert.alert('Saved offline');\n    navigation.goBack();\n  };\n  return _jsxDEV(SafeAreaView, {\n    style: {\n      padding: 16\n    },\n    children: [_jsxDEV(Text, {\n      style: {\n        fontSize: 18,\n        marginBottom: 8\n      },\n      children: \"New Lead\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Describe the job...\",\n      value: description,\n      onChangeText: setDescription,\n      multiline: true,\n      style: {\n        borderWidth: 1,\n        minHeight: 120,\n        padding: 10,\n        marginBottom: 12\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 7\n    }, this), _jsxDEV(Button, {\n      title: \"Create Lead\",\n      onPress: async () => {\n        try {\n          await createLeadOnline();\n          navigation.goBack();\n        } catch (e) {\n          queueLead();\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 287,\n    columnNumber: 5\n  }, this);\n}\nfunction EstimateEditorScreen({\n  route,\n  navigation\n}) {\n  const {\n    token,\n    user\n  } = useAuth();\n  const {\n    leadId\n  } = route.params || {};\n  const [estimateId, setEstimateId] = useState(null);\n  const [items, setItems] = useState([]);\n  const [desc, setDesc] = useState('');\n  const [qty, setQty] = useState('1');\n  const [price, setPrice] = useState('0');\n  const [notes, setNotes] = useState('');\n  const [photoUrl, setPhotoUrl] = useState(null);\n  const createEstimate = async () => {\n    const est = await api('/estimates', 'POST', {\n      leadId,\n      subtotal: 0,\n      taxRate: 7.0,\n      total: 0\n    }, token);\n    setEstimateId(est.id);\n  };\n  const addItem = async () => {\n    if (!estimateId) {\n      alert('Create estimate first');\n      return;\n    }\n    const data = await api(`/estimates/${estimateId}/items`, 'POST', {\n      description: desc,\n      qty: parseFloat(qty),\n      unitPrice: parseFloat(price)\n    }, token);\n    setItems(prev => [data, ...prev]);\n    setDesc('');\n    setQty('1');\n    setPrice('0');\n  };\n  const suggest = async () => {\n    const r = await api('/ai/estimate-suggest', 'POST', {\n      notes\n    }, token);\n    if (!estimateId) await createEstimate();\n    for (const it of r.items) {\n      await api(`/estimates/${estimateId}/items`, 'POST', it, token);\n    }\n    Alert.alert('Added', 'Suggested line-items added');\n  };\n  const pickPhoto = async () => {\n    const res = await ImagePicker.launchImageLibraryAsync({\n      base64: true,\n      quality: 0.6\n    });\n    if (!res.canceled && res.assets && res.assets[0].base64) {\n      const dataUrl = `data:image/jpeg;base64,${res.assets[0].base64}`;\n      try {\n        const up = await api('/upload/image', 'POST', {\n          dataUrl\n        }, token);\n        setPhotoUrl(up.url);\n      } catch (e) {\n        db.transaction(tx => tx.executeSql('INSERT INTO queue (type, payload) VALUES (?,?)', ['uploadPhoto', JSON.stringify({\n          dataUrl\n        })]));\n        Alert.alert('Queued upload', 'Will send when online');\n      }\n    }\n  };\n  const approveAndSign = () => {\n    if (!estimateId) {\n      Alert.alert('Create estimate');\n      return;\n    }\n    navigation.navigate('Signature', {\n      estimateId\n    });\n  };\n  const canEstimate = user?.role === 'ADMIN' || user?.role === 'ESTIMATOR';\n  return _jsxDEV(SafeAreaView, {\n    style: {\n      flex: 1,\n      padding: 16\n    },\n    children: [_jsxDEV(Text, {\n      style: {\n        fontSize: 18,\n        marginBottom: 8\n      },\n      children: [\"Estimate (Lead #\", leadId, \")\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 7\n    }, this), canEstimate ? _jsxDEV(Button, {\n      title: estimateId ? `Estimate #${estimateId}` : \"Create Estimate\",\n      onPress: createEstimate\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 22\n    }, this) : _jsxDEV(Text, {\n      children: \"View only (insufficient role)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 127\n    }, this), _jsxDEV(View, {\n      style: {\n        height: 12\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Item description\",\n      value: desc,\n      onChangeText: setDesc,\n      style: {\n        borderWidth: 1,\n        padding: 8,\n        marginBottom: 6\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Qty\",\n      value: qty,\n      onChangeText: setQty,\n      keyboardType: \"decimal-pad\",\n      style: {\n        borderWidth: 1,\n        padding: 8,\n        marginBottom: 6\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Unit Price\",\n      value: price,\n      onChangeText: setPrice,\n      keyboardType: \"decimal-pad\",\n      style: {\n        borderWidth: 1,\n        padding: 8,\n        marginBottom: 6\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 7\n    }, this), canEstimate && _jsxDEV(Button, {\n      title: \"Add Item\",\n      onPress: addItem\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 23\n    }, this), _jsxDEV(View, {\n      style: {\n        height: 16\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 7\n    }, this), _jsxDEV(Text, {\n      style: {\n        fontWeight: '600'\n      },\n      children: \"AI helper\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Paste field notes...\",\n      value: notes,\n      onChangeText: setNotes,\n      multiline: true,\n      style: {\n        borderWidth: 1,\n        minHeight: 80,\n        padding: 8,\n        marginBottom: 6\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 7\n    }, this), canEstimate && _jsxDEV(Button, {\n      title: \"Suggest Line Items\",\n      onPress: suggest\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 23\n    }, this), _jsxDEV(View, {\n      style: {\n        height: 16\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 7\n    }, this), _jsxDEV(Button, {\n      title: \"Attach Photo\",\n      onPress: pickPhoto\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 7\n    }, this), photoUrl ? _jsxDEV(Image, {\n      source: {\n        uri: `${API_URL}${photoUrl}`\n      },\n      style: {\n        height: 120,\n        marginTop: 8\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 19\n    }, this) : null, _jsxDEV(View, {\n      style: {\n        height: 16\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 7\n    }, this), _jsxDEV(Button, {\n      title: \"Approve & Sign\",\n      onPress: approveAndSign\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 7\n    }, this), _jsxDEV(View, {\n      style: {\n        height: 16\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 7\n    }, this), _jsxDEV(FlatList, {\n      data: items,\n      keyExtractor: (i, idx) => String(i.id || idx),\n      renderItem: ({\n        item\n      }) => _jsxDEV(View, {\n        style: {\n          padding: 10,\n          borderWidth: 1,\n          marginBottom: 8\n        },\n        children: [_jsxDEV(Text, {\n          style: {\n            fontWeight: '600'\n          },\n          children: item.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this), _jsxDEV(Text, {\n          children: [\"Qty: \", item.qty, \" \\xD7 $\", item.unitPrice, \" = $\", (parseFloat(item.qty || 0) * parseFloat(item.unitPrice || 0)).toFixed(2)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 343,\n    columnNumber: 5\n  }, this);\n}\nfunction ScheduleScreen() {\n  const {\n    token\n  } = useAuth();\n  useEffect(() => {\n    processQueue(token);\n  }, [token]);\n  return _jsxDEV(SafeAreaView, {\n    style: {\n      flex: 1,\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    children: _jsxDEV(Text, {\n      children: \"Schedule (v1 placeholder)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 89\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 378,\n    columnNumber: 10\n  }, this);\n}\nfunction MeScreen({\n  navigation\n}) {\n  const {\n    setToken,\n    user\n  } = useAuth();\n  return _jsxDEV(SafeAreaView, {\n    style: {\n      flex: 1,\n      padding: 16\n    },\n    children: [_jsxDEV(Text, {\n      style: {\n        fontSize: 20,\n        fontWeight: '600'\n      },\n      children: \"PrecisionTracker\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 7\n    }, this), _jsxDEV(Text, {\n      children: [\"User: \", user?.email, \" (\", user?.role, \")\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 7\n    }, this), user?.role === 'ADMIN' && _jsxDEV(View, {\n      style: {\n        height: 12\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 32\n    }, this), user?.role === 'ADMIN' && _jsxDEV(Button, {\n      title: \"Manage Users\",\n      onPress: () => navigation.navigate('UsersAdmin')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 32\n    }, this), _jsxDEV(View, {\n      style: {\n        height: 20\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 7\n    }, this), _jsxDEV(Button, {\n      title: \"Sign out\",\n      onPress: () => setToken(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 384,\n    columnNumber: 5\n  }, this);\n}\nconst Stack = createNativeStackNavigator();\nconst Tabs = createBottomTabNavigator();\nfunction TabsNav() {\n  return _jsxDEV(Tabs.Navigator, {\n    children: [_jsxDEV(Tabs.Screen, {\n      name: \"Leads\",\n      component: LeadsScreen\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 7\n    }, this), _jsxDEV(Tabs.Screen, {\n      name: \"Jobs\",\n      component: JobsKanbanScreen,\n      options: {\n        title: 'Jobs'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 7\n    }, this), _jsxDEV(Tabs.Screen, {\n      name: \"Schedule\",\n      component: ScheduleScreen\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 7\n    }, this), _jsxDEV(Tabs.Screen, {\n      name: \"Me\",\n      component: MeScreen\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 400,\n    columnNumber: 5\n  }, this);\n}\nfunction LoginScreen() {\n  const [email, setEmail] = useState('admin@example.com');\n  const [password, setPassword] = useState('test123');\n  const [busy, setBusy] = useState(false);\n  const {\n    setToken,\n    setUser\n  } = useAuth();\n  async function login() {\n    try {\n      setBusy(true);\n      const res = await fetch(`${API_URL}/auth/login`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email,\n          password\n        })\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error(data?.message || data?.error || 'Login failed');\n      const tok = data.token || data.accessToken;\n      if (!tok) throw new Error('No token returned from server');\n      setToken(tok);\n      setUser(data.user || {\n        email,\n        role: 'Admin',\n        name: 'Admin'\n      });\n      Alert.alert('Welcome', 'Logged in');\n    } catch (e) {\n      Alert.alert('Error', e.message);\n    } finally {\n      setBusy(false);\n    }\n  }\n  return _jsxDEV(View, {\n    style: {\n      flex: 1,\n      padding: 20,\n      justifyContent: 'center'\n    },\n    children: [_jsxDEV(Text, {\n      style: {\n        fontSize: 24,\n        marginBottom: 16\n      },\n      children: \"PrecisionTracker\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Email\",\n      autoCapitalize: \"none\",\n      value: email,\n      onChangeText: setEmail,\n      style: {\n        borderWidth: 1,\n        padding: 12,\n        marginBottom: 12\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 7\n    }, this), _jsxDEV(TextInput, {\n      placeholder: \"Password\",\n      secureTextEntry: true,\n      value: password,\n      onChangeText: setPassword,\n      style: {\n        borderWidth: 1,\n        padding: 12,\n        marginBottom: 12\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 7\n    }, this), _jsxDEV(Button, {\n      title: busy ? 'Signing in…' : 'Sign in',\n      onPress: login,\n      disabled: busy\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 447,\n    columnNumber: 5\n  }, this);\n}\nexport default function App() {\n  const [token, setToken] = useState(null);\n  const [user, setUser] = useState(null);\n  return _jsxDEV(AuthContext.Provider, {\n    value: {\n      token,\n      setToken,\n      user,\n      setUser\n    },\n    children: _jsxDEV(NavigationContainer, {\n      children: !token ? _jsxDEV(Stack.Navigator, {\n        children: _jsxDEV(Stack.Screen, {\n          name: \"Login\",\n          component: LoginScreen\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 477,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 476,\n        columnNumber: 11\n      }, this) : _jsxDEV(Stack.Navigator, {\n        children: [_jsxDEV(Stack.Screen, {\n          name: \"Tabs\",\n          component: TabsNav,\n          options: {\n            headerShown: false\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 13\n        }, this), _jsxDEV(Stack.Screen, {\n          name: \"NewLead\",\n          component: NewLeadScreen,\n          options: {\n            title: 'New Lead'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 482,\n          columnNumber: 13\n        }, this), _jsxDEV(Stack.Screen, {\n          name: \"EstimateEditor\",\n          component: EstimateEditorScreen,\n          options: {\n            title: 'Estimate'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 13\n        }, this), _jsxDEV(Stack.Screen, {\n          name: \"Signature\",\n          component: SignatureScreen,\n          options: {\n            title: 'Signature'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 13\n        }, this), _jsxDEV(Stack.Screen, {\n          name: \"UsersAdmin\",\n          component: UsersAdminScreen,\n          options: {\n            title: 'Users (Admin)'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 13\n        }, this), _jsxDEV(Stack.Screen, {\n          name: \"JobDetail\",\n          component: JobDetailScreen,\n          options: {\n            title: 'Job'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 480,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 473,\n    columnNumber: 5\n  }, this);\n}","map":{"version":3,"names":["React","useEffect","useState","createContext","useContext","useRef","NavigationContainer","createNativeStackNavigator","createBottomTabNavigator","Text","TextInput","Button","FlatList","TouchableOpacity","SafeAreaView","Alert","Image","ScrollView","RefreshControl","ImagePicker","SQLite","Svg","Path","ViewShot","Platform","View","SecureStore","jsxDEV","_jsxDEV","API_URL","process","env","EXPO_PUBLIC_API_URL","db","getDb","OS","transaction","fn","executeSql","execAsync","runAsync","openDatabaseSync","alert","dbHandle","AuthContext","useAuth","api","path","method","body","token","res","fetch","headers","Object","assign","Authorization","JSON","stringify","undefined","ok","Error","json","error","SignaturePad","onCapturePng","points","setPoints","setPath","shotRef","ref","options","format","quality","result","style","height","borderWidth","backgroundColor","children","onStartShouldSetResponder","onResponderMove","e","x","nativeEvent","locationX","y","locationY","p","onResponderRelease","base64","current","capture","flex","width","d","stroke","strokeWidth","fill","fileName","_jsxFileName","lineNumber","columnNumber","SignatureScreen","route","navigation","estimateId","params","sigPng","setSigPng","save","resp","signaturePngUrl","paymentLink","goBack","padding","fontSize","marginBottom","title","onPress","UsersAdminScreen","users","setUsers","email","setEmail","fullName","setFullName","role","setRole","load","invite","promote","id","newRole","fontWeight","placeholder","value","onChangeText","marginVertical","autoCapitalize","data","keyExtractor","u","String","renderItem","item","flexDirection","gap","marginTop","JobsKanbanScreen","jobs","setJobs","columns","horizontal","contentContainerStyle","map","col","marginRight","filter","j","status","borderRadius","navigate","jobId","name","JobDetailScreen","user","changeOrders","setCO","setTitle","amountDelta","setAmountDelta","addCO","parseFloat","keyboardType","i","processQueue","Promise","resolve","tx","_","rows","items","_array","q","payload","parse","type","dataUrl","txx","LeadsScreen","leads","setLeads","fetchLeads","forEach","l","description","leadId","numberOfLines","ListHeaderComponent","NewLeadScreen","setDescription","createLeadOnline","queueLead","multiline","minHeight","EstimateEditorScreen","setEstimateId","setItems","desc","setDesc","qty","setQty","price","setPrice","notes","setNotes","photoUrl","setPhotoUrl","createEstimate","est","subtotal","taxRate","total","addItem","unitPrice","prev","suggest","r","it","pickPhoto","launchImageLibraryAsync","canceled","assets","up","url","approveAndSign","canEstimate","source","uri","idx","toFixed","ScheduleScreen","alignItems","justifyContent","MeScreen","setToken","Stack","Tabs","TabsNav","Navigator","Screen","component","LoginScreen","password","setPassword","busy","setBusy","setUser","login","message","tok","accessToken","secureTextEntry","disabled","App","Provider","headerShown"],"sources":["C:/Users/Tyler/Downloads/PrecisionTracker-v4-wired/PrecisionTracker/mobile/App.js"],"sourcesContent":["\nimport React, { useEffect, useState, createContext, useContext, useRef } from 'react';\nimport { NavigationContainer } from '@react-navigation/native';\nimport { createNativeStackNavigator } from '@react-navigation/native-stack';\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\nimport {Text, TextInput, Button, FlatList, TouchableOpacity, SafeAreaView, Alert, Image, ScrollView, RefreshControl } from 'react-native';\nimport * as ImagePicker from 'expo-image-picker';\nimport * as SQLite from 'expo-sqlite';\nimport Svg, { Path } from 'react-native-svg';\nimport ViewShot from 'react-native-view-shot';\nimport { Platform, View } from 'react-native';\nimport * as SecureStore from 'expo-secure-store';\n// import * as SQLite from 'expo-sqlite';\n\n\nconst API_URL = process.env.EXPO_PUBLIC_API_URL || 'http://localhost:4000';\n// const db = SQLite.openDatabase('offline.db');\n\n// function initDB(){\n//   db.transaction(tx => {\n//     tx.executeSql('CREATE TABLE IF NOT EXISTS queue (id INTEGER PRIMARY KEY AUTOINCREMENT, type TEXT, payload TEXT);');\n//     tx.executeSql('CREATE TABLE IF NOT EXISTS uploads (id INTEGER PRIMARY KEY AUTOINCREMENT, dataUrl TEXT);');\n//     tx.executeSql('CREATE TABLE IF NOT EXISTS leads_cache (id INTEGER PRIMARY KEY, description TEXT, status TEXT);');\n//   });\n// }\n\nlet db;\nexport function getDb() {\n  if (db) return db;\n\n  // Web: safe no-op DB\n  if (Platform.OS === 'web') {\n    db = {\n      transaction: (fn) => fn({ executeSql: () => {} }),\n      execAsync: async () => {},\n      runAsync: async () => {},\n    };\n    return db;\n  }\n\n  // SDK 51+: prefer sync, then async; DO NOT reference openDatabase (removed)\n  if ('openDatabaseSync' in SQLite) {\n    db = SQLite.openDatabaseSync('offline.db');\n    return db;\n  }\n\n  if ('openDatabaseAsync' in SQLite) {\n    // Minimal adapter so existing code won’t crash; refactor later if needed\n    Alert.alert('Info', 'Using async SQLite; offline queue limited until refactor.');\n    db = {\n      transaction: (fn) => fn({ executeSql: () => {} }),\n      execAsync: async () => {},\n      runAsync: async () => {},\n    };\n    return db;\n  }\n\n  // Safety fallback\n  db = {\n    transaction: (fn) => fn({ executeSql: () => {} }),\n    execAsync: async () => {},\n    runAsync: async () => {},\n  };\n  return db;\n}\n\n// use:\nconst dbHandle = getDb();\n\nconst AuthContext = createContext(null);\nfunction useAuth(){ return useContext(AuthContext); }\nasync function api(path, method='GET', body, token){\n  const res = await fetch(`${API_URL}${path}`, {\n    method, headers: { 'Content-Type':'application/json', ...(token?{Authorization:`Bearer ${token}`}:{}) },\n    body: body?JSON.stringify(body):undefined\n  });\n  if(!res.ok){ throw new Error((await res.json()).error || 'Request failed'); }\n  return res.json();\n}\n\n// ---------- Signature Pad to PNG ----------\nfunction SignaturePad({ onCapturePng }){\n  const [points, setPoints] = useState([]);\n  const [path, setPath] = useState('');\n  const shotRef = useRef(null);\n  return (\n    <ViewShot ref={shotRef} options={{ format: 'png', quality: 0.9, result: 'base64' }} style={{ height:220, borderWidth:1, backgroundColor:'#fff' }}>\n      <View\n        onStartShouldSetResponder={()=>true}\n        onResponderMove={(e)=>{\n          const x = e.nativeEvent.locationX, y = e.nativeEvent.locationY;\n          setPath(p => p + (p ? ` L ${x} ${y}` : ` M ${x} ${y}`));\n        }}\n        onResponderRelease={async ()=>{\n          const base64 = await shotRef.current.capture();\n          onCapturePng && onCapturePng('data:image/png;base64,' + base64);\n        }}\n        style={{ flex:1 }}\n      >\n        <Svg height=\"100%\" width=\"100%\"><Path d={path} stroke=\"black\" strokeWidth=\"2\" fill=\"none\" /></Svg>\n      </View>\n    </ViewShot>\n  );\n}\n\nfunction SignatureScreen({ route, navigation }){\n  const { token } = useAuth();\n  const { estimateId } = route.params;\n  const [sigPng, setSigPng] = useState(null);\n  const save = async () => {\n    if(!sigPng){ Alert.alert('Please sign first'); return; }\n    const resp = await api(`/estimates/${estimateId}/approve`, 'POST', { signaturePngUrl: sigPng }, token);\n    Alert.alert('Approved', `Payment link:\\n${(resp && resp.paymentLink) ? resp.paymentLink : 'Unavailable'}`); navigation.goBack();\n  };\n  return (\n    <SafeAreaView style={{ padding:16 }}>\n      <Text style={{ fontSize:18, marginBottom:8 }}>Sign Estimate #{estimateId}</Text>\n      <SignaturePad onCapturePng={setSigPng} />\n      <View style={{ height:12 }} />\n      <Button title=\"Save Signature\" onPress={save} />\n    </SafeAreaView>\n  );\n}\n\n// ---------- Admin: Users ----------\nfunction UsersAdminScreen(){\n  const { token } = useAuth();\n  const [users, setUsers] = useState([]);\n  const [email, setEmail] = useState('');\n  const [fullName, setFullName] = useState('');\n  const [role, setRole] = useState('TECH');\n  const load = async ()=> setUsers(await api('/users','GET',null,token));\n  useEffect(()=>{ load(); },[]);\n  const invite = async ()=>{\n    await api('/users','POST', { email, fullName, role }, token);\n    setEmail(''); setFullName(''); setRole('TECH'); load();\n  };\n  const promote = async (id, newRole)=>{\n    await api(`/users/${id}`,'PATCH',{ role: newRole }, token); load();\n  };\n  return (\n    <SafeAreaView style={{ flex:1, padding:16 }}>\n      <Text style={{ fontSize:18, fontWeight:'600' }}>Invite User</Text>\n      <TextInput placeholder=\"Full name\" value={fullName} onChangeText={setFullName} style={{ borderWidth:1, padding:8, marginVertical:6 }} />\n      <TextInput placeholder=\"Email\" value={email} onChangeText={setEmail} autoCapitalize='none' style={{ borderWidth:1, padding:8, marginVertical:6 }} />\n      <TextInput placeholder=\"Role (ADMIN/ESTIMATOR/SUPERVISOR/TECH)\" value={role} onChangeText={setRole} style={{ borderWidth:1, padding:8, marginVertical:6 }} />\n      <Button title=\"Create User\" onPress={invite} />\n      <View style={{ height:16 }} />\n      <FlatList data={users} keyExtractor={u=>String(u.id)} renderItem={({item}) => (\n        <View style={{ padding:12, borderWidth:1, marginBottom:8 }}>\n          <Text style={{ fontWeight:'600' }}>{item.fullName || item.email}</Text>\n          <Text>{item.email}</Text>\n          <Text>Role: {item.role}</Text>\n          <View style={{ flexDirection:'row', gap:8, marginTop:8 }}>\n            <Button title=\"Admin\" onPress={()=>promote(item.id,'ADMIN')} />\n            <Button title=\"Estimator\" onPress={()=>promote(item.id,'ESTIMATOR')} />\n            <Button title=\"Supervisor\" onPress={()=>promote(item.id,'SUPERVISOR')} />\n            <Button title=\"Tech\" onPress={()=>promote(item.id,'TECH')} />\n          </View>\n        </View>\n      )}/>\n    </SafeAreaView>\n  );\n}\n\n// ---------- Jobs Kanban + Change Orders ----------\nfunction JobsKanbanScreen({ navigation }){\n  const { token } = useAuth();\n  const [jobs, setJobs] = useState([]);\n  const load = async ()=> setJobs(await api('/jobs','GET',null,token));\n  useEffect(()=>{ load(); },[]);\n  const columns = ['SCHEDULED','IN_PROGRESS','ON_HOLD','DONE'];\n  return (\n    <SafeAreaView style={{ flex:1 }}>\n      <ScrollView horizontal contentContainerStyle={{ padding:12 }}>\n        {columns.map(col => (\n          <View key={col} style={{ width:300, marginRight:12 }}>\n            <Text style={{ fontWeight:'700', marginBottom:8 }}>{col}</Text>\n            {jobs.filter(j=>j.status===col).map(j => (\n              <TouchableOpacity key={j.id} style={{ borderWidth:1, padding:10, borderRadius:8, marginBottom:8 }} onPress={()=>navigation.navigate('JobDetail', { jobId: j.id })}>\n                <Text style={{ fontWeight:'600' }}>{j.name || `Job #${j.id}`}</Text>\n                <Text>#{j.id}</Text>\n              </TouchableOpacity>\n            ))}\n          </View>\n        ))}\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nfunction JobDetailScreen({ route }){\n  const { jobId } = route.params;\n  const { token, user } = useAuth();\n  const [changeOrders, setCO] = useState([]);\n  const [title, setTitle] = useState('');\n  const [amountDelta, setAmountDelta] = useState('0');\n  const load = async ()=> setCO(await api(`/change-orders/job/${jobId}`,'GET',null,token));\n  useEffect(()=>{ load(); },[]);\n  const addCO = async ()=>{\n    await api(`/change-orders/job/${jobId}`,'POST',{ title, amountDelta: parseFloat(amountDelta) }, token);\n    setTitle(''); setAmountDelta('0'); load();\n  };\n  return (\n    <SafeAreaView style={{ flex:1, padding:16 }}>\n      <Text style={{ fontSize:18, fontWeight:'600' }}>Job #{jobId}</Text>\n      {(user?.role==='ADMIN'||user?.role==='SUPERVISOR'||user?.role==='ESTIMATOR') && (\n        <View style={{ marginVertical:10 }}>\n          <Text style={{ fontWeight:'600' }}>New Change Order</Text>\n          <TextInput placeholder=\"Title\" value={title} onChangeText={setTitle} style={{ borderWidth:1, padding:8, marginVertical:6 }} />\n          <TextInput placeholder=\"Amount Δ\" value={amountDelta} onChangeText={setAmountDelta} keyboardType=\"decimal-pad\" style={{ borderWidth:1, padding:8, marginVertical:6 }} />\n          <Button title=\"Add Change Order\" onPress={addCO} />\n        </View>\n      )}\n      <Text style={{ fontWeight:'600', marginTop:12 }}>Change Orders</Text>\n      <FlatList data={changeOrders} keyExtractor={i=>String(i.id)} renderItem={({item}) => (\n        <View style={{ borderWidth:1, padding:10, borderRadius:8, marginVertical:6 }}>\n          <Text style={{ fontWeight:'600' }}>{item.title}</Text>\n          <Text>Status: {item.status} | Δ ${item.amountDelta}</Text>\n        </View>\n      )}/>\n    </SafeAreaView>\n  );\n}\n\n// ---------- Leads / Estimates (with photo queue) ----------\nasync function processQueue(token){\n  return new Promise(resolve => {\n    db.transaction(tx => {\n      tx.executeSql('SELECT * FROM queue', [], async (_, { rows }) => {\n        const items = rows._array || [];\n        for(const q of items){\n          try{\n            const payload = JSON.parse(q.payload);\n            if(q.type === 'createLead'){ await api('/leads', 'POST', payload, token); }\n            if(q.type === 'uploadPhoto'){ await api('/upload/image', 'POST', { dataUrl: payload.dataUrl }, token); }\n            db.transaction(txx => txx.executeSql('DELETE FROM queue WHERE id=?', [q.id]));\n          }catch(e){ /* keep for later */ }\n        }\n        resolve();\n      });\n    });\n  });\n}\n\nfunction LeadsScreen({ navigation }){\n  const { token } = useAuth();\n  const [leads, setLeads] = useState([]);\n  const fetchLeads = async () => {\n    try {\n      const data = await api('/leads', 'GET', null, token);\n      setLeads(data);\n      db.transaction(tx => {\n        tx.executeSql('DELETE FROM leads_cache;');\n        data.forEach(l => tx.executeSql('INSERT OR REPLACE INTO leads_cache (id, description, status) VALUES (?,?,?)', [l.id, l.description||'', l.status||'NEW']));\n      });\n    } catch(e){\n      db.transaction(tx => tx.executeSql('SELECT id, description, status FROM leads_cache', [], (_, { rows }) => setLeads(rows._array || [])));\n    }\n  };\n  useEffect(() => { fetchLeads(); }, []);\n  return (\n    <SafeAreaView style={{ flex:1 }}>\n      <FlatList\n        data={leads}\n        keyExtractor={item => String(item.id)}\n        contentContainerStyle={{ padding:12 }}\n        renderItem={({ item }) => (\n          <TouchableOpacity style={{ padding:12, borderWidth:1, marginBottom:8 }} onPress={() => navigation.navigate('EstimateEditor', { leadId: item.id })}>\n            <Text style={{ fontWeight:'600' }}>Lead #{item.id}</Text>\n            <Text numberOfLines={2}>{item.description || 'No description'}</Text>\n            <Text>Status: {item.status}</Text>\n          </TouchableOpacity>\n        )}\n        ListHeaderComponent={<Button title=\"New Lead\" onPress={()=>navigation.navigate('NewLead')} />}\n      />\n    </SafeAreaView>\n  );\n}\n\nfunction NewLeadScreen({ navigation }){\n  const { token } = useAuth();\n  const [description, setDescription] = useState('');\n  const createLeadOnline = async () => { await api('/leads', 'POST', { description }, token); };\n  const queueLead = () => { db.transaction(tx => tx.executeSql('INSERT INTO queue (type, payload) VALUES (?,?)', ['createLead', JSON.stringify({ description })])); Alert.alert('Saved offline'); navigation.goBack(); };\n  return (\n    <SafeAreaView style={{ padding:16 }}>\n      <Text style={{ fontSize:18, marginBottom:8 }}>New Lead</Text>\n      <TextInput placeholder=\"Describe the job...\" value={description} onChangeText={setDescription} multiline style={{ borderWidth:1, minHeight:120, padding:10, marginBottom:12 }} />\n      <Button title=\"Create Lead\" onPress={async ()=>{ try{ await createLeadOnline(); navigation.goBack(); } catch(e){ queueLead(); } }} />\n    </SafeAreaView>\n  );\n}\n\nfunction EstimateEditorScreen({ route, navigation }){\n  const { token, user } = useAuth();\n  const { leadId } = route.params || {};\n  const [estimateId, setEstimateId] = useState(null);\n  const [items, setItems] = useState([]);\n  const [desc, setDesc] = useState('');\n  const [qty, setQty] = useState('1');\n  const [price, setPrice] = useState('0');\n  const [notes, setNotes] = useState('');\n  const [photoUrl, setPhotoUrl] = useState(null);\n\n  const createEstimate = async () => {\n    const est = await api('/estimates', 'POST', { leadId, subtotal:0, taxRate:7.0, total:0 }, token);\n    setEstimateId(est.id);\n  };\n\n  const addItem = async () => {\n    if(!estimateId){ alert('Create estimate first'); return; }\n    const data = await api(`/estimates/${estimateId}/items`, 'POST', { description: desc, qty: parseFloat(qty), unitPrice: parseFloat(price) }, token);\n    setItems(prev => [data, ...prev]); setDesc(''); setQty('1'); setPrice('0');\n  };\n\n  const suggest = async () => {\n    const r = await api('/ai/estimate-suggest', 'POST', { notes }, token);\n    if(!estimateId) await createEstimate();\n    for(const it of r.items){ await api(`/estimates/${estimateId}/items`, 'POST', it, token); }\n    Alert.alert('Added', 'Suggested line-items added');\n  };\n\n  const pickPhoto = async () => {\n    const res = await ImagePicker.launchImageLibraryAsync({ base64: true, quality: 0.6 });\n    if(!res.canceled && res.assets && res.assets[0].base64){\n      const dataUrl = `data:image/jpeg;base64,${res.assets[0].base64}`;\n      try {\n        const up = await api('/upload/image', 'POST', { dataUrl }, token);\n        setPhotoUrl(up.url);\n      } catch(e){\n        db.transaction(tx => tx.executeSql('INSERT INTO queue (type, payload) VALUES (?,?)', ['uploadPhoto', JSON.stringify({ dataUrl })]));\n        Alert.alert('Queued upload', 'Will send when online');\n      }\n    }\n  };\n\n  const approveAndSign = () => { if(!estimateId){ Alert.alert('Create estimate'); return; } navigation.navigate('Signature', { estimateId }); };\n\n  const canEstimate = user?.role === 'ADMIN' || user?.role === 'ESTIMATOR';\n\n  return (\n    <SafeAreaView style={{ flex:1, padding:16 }}>\n      <Text style={{ fontSize:18, marginBottom:8 }}>Estimate (Lead #{leadId})</Text>\n      {canEstimate ? <Button title={estimateId ? `Estimate #${estimateId}` : \"Create Estimate\"} onPress={createEstimate} /> : <Text>View only (insufficient role)</Text>}\n      <View style={{ height:12 }} />\n      <TextInput placeholder=\"Item description\" value={desc} onChangeText={setDesc} style={{ borderWidth:1, padding:8, marginBottom:6 }} />\n      <TextInput placeholder=\"Qty\" value={qty} onChangeText={setQty} keyboardType='decimal-pad' style={{ borderWidth:1, padding:8, marginBottom:6 }} />\n      <TextInput placeholder=\"Unit Price\" value={price} onChangeText={setPrice} keyboardType='decimal-pad' style={{ borderWidth:1, padding:8, marginBottom:6 }} />\n      {canEstimate && <Button title=\"Add Item\" onPress={addItem} />}\n      <View style={{ height:16 }} />\n      <Text style={{ fontWeight:'600' }}>AI helper</Text>\n      <TextInput placeholder=\"Paste field notes...\" value={notes} onChangeText={setNotes} multiline style={{ borderWidth:1, minHeight:80, padding:8, marginBottom:6 }} />\n      {canEstimate && <Button title=\"Suggest Line Items\" onPress={suggest} />}\n      <View style={{ height:16 }} />\n      <Button title=\"Attach Photo\" onPress={pickPhoto} />\n      {photoUrl ? <Image source={{ uri: `${API_URL}${photoUrl}` }} style={{ height:120, marginTop:8 }} /> : null}\n      <View style={{ height:16 }} />\n      <Button title=\"Approve & Sign\" onPress={approveAndSign} />\n      <View style={{ height:16 }} />\n      <FlatList\n        data={items}\n        keyExtractor={(i, idx)=> String(i.id || idx)}\n        renderItem={({ item }) => (\n          <View style={{ padding:10, borderWidth:1, marginBottom:8 }}>\n            <Text style={{ fontWeight:'600' }}>{item.description}</Text>\n            <Text>Qty: {item.qty} × ${item.unitPrice} = ${ (parseFloat(item.qty||0)*parseFloat(item.unitPrice||0)).toFixed(2) }</Text>\n          </View>\n        )}\n      />\n    </SafeAreaView>\n  );\n}\n\nfunction ScheduleScreen(){\n  const { token } = useAuth();\n  useEffect(()=>{ processQueue(token); }, [token]);\n  return <SafeAreaView style={{ flex:1, alignItems:'center', justifyContent:'center' }}><Text>Schedule (v1 placeholder)</Text></SafeAreaView>;\n}\n\nfunction MeScreen({ navigation }){\n  const { setToken, user } = useAuth();\n  return (\n    <SafeAreaView style={{ flex:1, padding:16 }}>\n      <Text style={{ fontSize:20, fontWeight:'600' }}>PrecisionTracker</Text>\n      <Text>User: {user?.email} ({user?.role})</Text>\n      {user?.role==='ADMIN' && <View style={{ height:12 }} />}\n      {user?.role==='ADMIN' && <Button title=\"Manage Users\" onPress={()=>navigation.navigate('UsersAdmin')} />}\n      <View style={{ height:20 }} />\n      <Button title=\"Sign out\" onPress={()=>setToken(null)} />\n    </SafeAreaView>\n  );\n}\n\nconst Stack = createNativeStackNavigator();\nconst Tabs = createBottomTabNavigator();\n\nfunction TabsNav(){\n  return (\n    <Tabs.Navigator>\n      <Tabs.Screen name=\"Leads\" component={LeadsScreen} />\n      <Tabs.Screen name=\"Jobs\" component={JobsKanbanScreen} options={{ title:'Jobs' }} />\n      <Tabs.Screen name=\"Schedule\" component={ScheduleScreen} />\n      <Tabs.Screen name=\"Me\" component={MeScreen} />\n    </Tabs.Navigator>\n  );\n}\n\nfunction LoginScreen() {\n  const [email, setEmail] = useState('admin@example.com');\n  // If you kept the hardcoded backend login, default to test123:\n  const [password, setPassword] = useState('test123');\n  const [busy, setBusy] = useState(false);\n\n  // <-- use the auth context to flip the app into \"logged-in\" mode\n  const { setToken, setUser } = useAuth();\n\n  async function login() {\n    try {\n      setBusy(true);\n      const res = await fetch(`${API_URL}/auth/login`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, password }),\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error(data?.message || data?.error || 'Login failed');\n\n      // Accept dev or real payload shape\n      const tok = data.token || data.accessToken;\n      if (!tok) throw new Error('No token returned from server');\n\n      // ⬇️ This is the key: store token/user in global auth state\n      setToken(tok);\n      setUser(data.user || { email, role: 'Admin', name: 'Admin' });\n\n      // Optional: toast\n      Alert.alert('Welcome', 'Logged in');\n    } catch (e) {\n      Alert.alert('Error', e.message);\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <View style={{ flex: 1, padding: 20, justifyContent: 'center' }}>\n      <Text style={{ fontSize: 24, marginBottom: 16 }}>PrecisionTracker</Text>\n      <TextInput\n        placeholder=\"Email\"\n        autoCapitalize=\"none\"\n        value={email}\n        onChangeText={setEmail}\n        style={{ borderWidth: 1, padding: 12, marginBottom: 12 }}\n      />\n      <TextInput\n        placeholder=\"Password\"\n        secureTextEntry\n        value={password}\n        onChangeText={setPassword}\n        style={{ borderWidth: 1, padding: 12, marginBottom: 12 }}\n      />\n      <Button title={busy ? 'Signing in…' : 'Sign in'} onPress={login} disabled={busy} />\n    </View>\n  );\n}\n\n\nexport default function App(){\n  const [token, setToken] = useState(null);\n  const [user, setUser] = useState(null);\n  return (\n    <AuthContext.Provider value={{ token, setToken, user, setUser }}>\n      <NavigationContainer>\n        {!token ? (\n          <Stack.Navigator>\n            <Stack.Screen name=\"Login\" component={LoginScreen} />\n          </Stack.Navigator>\n        ) : (\n          <Stack.Navigator>\n            <Stack.Screen name=\"Tabs\" component={TabsNav} options={{ headerShown:false }} />\n            <Stack.Screen name=\"NewLead\" component={NewLeadScreen} options={{ title:'New Lead' }} />\n            <Stack.Screen name=\"EstimateEditor\" component={EstimateEditorScreen} options={{ title:'Estimate' }} />\n            <Stack.Screen name=\"Signature\" component={SignatureScreen} options={{ title:'Signature' }} />\n            <Stack.Screen name=\"UsersAdmin\" component={UsersAdminScreen} options={{ title:'Users (Admin)' }} />\n            <Stack.Screen name=\"JobDetail\" component={JobDetailScreen} options={{ title:'Job' }} />\n          </Stack.Navigator>\n        )}\n      </NavigationContainer>\n    </AuthContext.Provider>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}